<div class="chatbox-display-open" *ngIf="!showBox" (click)="showBox = true">
  <mat-icon color="primary">chat</mat-icon>
</div>

<div class="chatbox-main" *ngIf="showBox">
  <div *ngIf="isAdmin" class="chatbox-user">
    <select [(ngModel)]="currentUser" (change)="filterMessages()">
      <option *ngFor="let user of users" value="{{user.username}}">
        {{user.username}}
        <span *ngIf="user.newMessages" class="new-message">Nuovo messaggio</span>
      </option>
    </select>
  </div>

  <div class="chatbox-display">
    <div class="chatbox-display-close" (click)="showBox = false">
      <mat-icon color="primary">close</mat-icon>
    </div>

    <p *ngFor="let m of displayMessages" class="message">
      <span *ngIf="m.from ==''" class="message-from">Io: </span>
      <span *ngIf="m.from !=''" class="message-from">{{m.from}}: </span>
      {{m.message}}
    </p>
  </div>

  <div class="chatbox-input">
    <div class="chatbox-textarea">
      <textarea [(ngModel)]="message"></textarea>
    </div>

    <div class="chatbox-button">
      <button mat-raised-button color="primary" (click)="sendMessage()">Invia</button>
    </div>
  </div>
</div>
